
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>PCOS Hospital Portal — Doctor Only</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    .dialog-backdrop { background: rgba(0,0,0,0.5); }
  </style>
</head>
<body class="bg-zinc-950 text-zinc-100">
  <div id="root"></div>
  <script type="text/babel">
    const { useEffect, useMemo, useState } = React;

    const STORAGE_KEY = "pcos-portal-v2";
    const SCREEN_LINK_KEY = "screening_link";
    const DEFAULT_LINK = "https://huggingface.co/spaces/ashsub/project_demo";

    function upcomingDay(n){
      const d=new Date();
      d.setDate(d.getDate()+n);
      return d.toISOString().slice(0,16);
    }

    function seedPatients() {
      const today = new Date().toISOString().slice(0,10);
      return [
        { id: "p1", email: "aisha@demo", name: "Aisha Verma", age: 23, height: 160, weight: 68, bmi: 26.6,
          cycle: "Irregular (40–55 days)", hirsutism: true, acne: true, familyHistory: true, lastTest: today,
          risk: 0.78, status: "Pending Review", labs: { LH: 11.2, FSH: 5.0, Testosterone: 78 },
          questionnaire: { cramps: true, mood: true, hairFall: true }, notes: "", recommendUSG: false, uploads: [] },
        { id: "p2", email: "nisha@demo", name: "Nisha Rao", age: 27, height: 155, weight: 52, bmi: 21.6,
          cycle: "Regular (28–31 days)", hirsutism: false, acne: false, familyHistory: false, lastTest: today,
          risk: 0.18, status: "Pending Review", labs: { LH: 6.3, FSH: 6.2, Testosterone: 38 },
          questionnaire: { cramps: false, mood: false, hairFall: false }, notes: "", recommendUSG: false, uploads: [] },
        { id: "p3", email: "sneha@demo", name: "Sneha Iyer", age: 21, height: 162, weight: 75, bmi: 28.6,
          cycle: "Irregular (45–70 days)", hirsutism: true, acne: true, familyHistory: false, lastTest: today,
          risk: 0.64, status: "Pending Review", labs: { LH: 10.1, FSH: 4.3, Testosterone: 66 },
          questionnaire: { cramps: true, mood: true, hairFall: true }, notes: "", recommendUSG: true, uploads: [] },
      ];
    }

    function seedAppointments() {
      return [
        { id: "a1", patientId: "p1", patient: "Aisha Verma", date: upcomingDay(1), type: "Consultation", withUltrasound: false, status: "Booked" },
        { id: "a2", patientId: "p3", patient: "Sneha Iyer", date: upcomingDay(2), type: "Consultation", withUltrasound: true, status: "Booked" },
      ];
    }

    function loadDB() {
      const raw = typeof window !== "undefined" ? localStorage.getItem(STORAGE_KEY) : null;
      const base = { patients: seedPatients(), appointments: seedAppointments(), reports: [], doctor: { id: "d1", name: "Dr. Meera Krishnan", email: "doctor@hospital.demo" } };
      if (!raw) return base;
      try { return { ...base, ...JSON.parse(raw) }; } catch { return base; }
    }

    function saveDB(db){ if (typeof window !== "undefined") localStorage.setItem(STORAGE_KEY, JSON.stringify(db)); }
    function getScreenLink(){ return localStorage.getItem(SCREEN_LINK_KEY) || DEFAULT_LINK; }
    function saveScreenLink(link){ localStorage.setItem(SCREEN_LINK_KEY, link); }

    // --- badges and UI components unchanged (RiskBadge, StatusBadge, Button, etc.) ---

    // --- DoctorConsole (UNCHANGED from your code) ---
    function DoctorConsole({ db, setDb, screenLink, setScreenLinkValue }) {
      // everything inside here is 100% identical to your original DoctorConsole
      // ...
    }

    // --- App (patched) ---
    function App(){
      const [db, setDb] = useState(loadDB());
      const [screenLink, setScreenLinkState] = useState(getScreenLink());

      useEffect(()=>{ saveDB(db); },[db]);

      // Directly load DoctorConsole (no login, no patient)
      return (
        <DoctorConsole db={db} setDb={setDb} screenLink={screenLink} setScreenLinkValue={setScreenLinkState} />
      );
    }

    // Mount
    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<App />);
  </script>
</body>
</html>
